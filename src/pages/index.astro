---
import { Grid } from "@/components/Grid";
import { getImage } from "astro:assets";
import Layout from "@/layouts/Layout.astro";
import type { GridItem } from "@/api";
import { getItems } from "@/api";
import { SITE_NAME } from "@/constants";

const items = await getItems();
const itemsForGrid: GridItem[] = items.map(
  (item) =>
    ({
      name: item.name,
      slug: item.slug,
      img: item.thumb.img,
      style: item.thumb.style,
    } satisfies GridItem)
);

const getIndexOgImage = async () => {
  const img = (await import(`../assets/og-image.png`)).default;
  const ogImage = await getImage({
    src: img,
    width: 1200,
    height: 630,
    quality: 60,
    format: "png",
  });
  return ogImage;
};
const ogImage = await getIndexOgImage();
---

<Layout title={SITE_NAME} bodyClass="overflow-hidden" ogImage={ogImage.src}>
  <section
    class="m-8 small-landscape:m-8 sm:m-24 flex h-[calc(100dvh_-_4rem)] small-landscape:h-[calc(100dvh_-_4rem)] sm:h-[calc(100dvh_-_12rem)] overflow-hidden shadow-lg small-landscape:shadow-lg sm:shadow-2xl rounded-2xl"
  >
    <Grid items={itemsForGrid} client:load />
  </section>
</Layout>
